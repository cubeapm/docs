"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4962],{5214:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"http-apis/logs","title":"Logs","description":"Ingestion (sending logs to CubeAPM)","source":"@site/docs/http-apis/logs.md","sourceDirName":"http-apis","slug":"/http-apis/logs-apis","permalink":"/http-apis/logs-apis","draft":false,"unlisted":false,"editUrl":"https://github.com/cubeapm/docs/docs/docs/http-apis/logs.md","tags":[],"version":"current","frontMatter":{"slug":"/http-apis/logs-apis"},"sidebar":"tutorialSidebar","previous":{"title":"HTTP APIs","permalink":"/http-apis"},"next":{"title":"Metrics","permalink":"/http-apis/metrics-apis"}}');var r=s(4848),i=s(8453);const l={slug:"/http-apis/logs-apis"},d="Logs",c={},a=[{value:"Ingestion (sending logs to CubeAPM)",id:"ingestion-sending-logs-to-cubeapm",level:2},{value:"Querying (fetching logs from CubeAPM)",id:"querying-fetching-logs-from-cubeapm",level:2},{value:"Request Parameters",id:"query-request-parameters",level:3},{value:"curl",id:"query-curl",level:3},{value:"Response Format",id:"query-response-format",level:3},{value:"Deletion (delete logs from CubeAPM)",id:"deletion-delete-logs-from-cubeapm",level:2},{value:"Run Delete Task",id:"run-delete-task",level:3},{value:"Request Parameters",id:"delete-run-task-request-parameters",level:4},{value:"curl",id:"delete-run-task-curl",level:4},{value:"Response Format",id:"delete-run-task-response-format",level:4},{value:"Stop Delete Task",id:"stop-delete-task",level:3},{value:"Request Parameters",id:"delete-stop-task-request-parameters",level:4},{value:"curl",id:"delete-stop-task-curl",level:4},{value:"Response Format",id:"delete-stop-task-response-format",level:4},{value:"List Active Delete Tasks",id:"list-active-delete-tasks",level:3},{value:"Request Parameters",id:"delete-active-tasks-request-parameters",level:4},{value:"curl",id:"delete-active-tasks-curl",level:4},{value:"Response Format",id:"delete-active-tasks-response-format",level:4}];function o(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"logs",children:"Logs"})}),"\n",(0,r.jsx)(t.h2,{id:"ingestion-sending-logs-to-cubeapm",children:"Ingestion (sending logs to CubeAPM)"}),"\n",(0,r.jsxs)(t.p,{children:["CubeAPM can receive logs in various formats. This makes it easy to integrate CubeAPM with a wide range of popular tools. Relevant details are available ",(0,r.jsx)(t.a,{href:"/logs/ingestion",children:"here"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"querying-fetching-logs-from-cubeapm",children:"Querying (fetching logs from CubeAPM)"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Endpoint:"})," ",(0,r.jsx)(t.code,{children:"POST"})," ",(0,r.jsx)(t.code,{children:"http://<ip_address_of_cubeapm_server>:3140/api/logs/select/logsql/query"})]}),"\n",(0,r.jsx)(t.h3,{id:"query-request-parameters",children:"Request Parameters"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"query"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"string"})}),(0,r.jsx)(t.td,{children:"The log search query, including stream filters."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"start"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"string/integer"})}),(0,r.jsx)(t.td,{children:"Start timestamp. Can be provided either in RFC3339 format or as a Unix timestamp in seconds."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"end"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"string/integer"})}),(0,r.jsx)(t.td,{children:"End timestamp. Can be provided either in RFC3339 format or as a Unix timestamp in seconds."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"limit"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"integer"})}),(0,r.jsxs)(t.td,{children:["The maximum number of log entries to return. Default is ",(0,r.jsx)(t.code,{children:"100"}),"."]})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"query-curl",children:"curl"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"curl 'http://<cubeapm_server>:3140/api/logs/select/logsql/query' \\\n  -H 'Content-Type: application/x-www-form-urlencoded' \\\n  --data-urlencode 'query={env=\"UNSET\",service.name=\"order\"} \"Completed initialization\" | sort by (_time) desc' \\\n  --data-urlencode 'start=2025-10-28T10:00:00Z' \\\n  --data-urlencode 'end=2025-10-28T10:00:10.100Z' \\\n  --data-urlencode 'limit=100'\n"})}),"\n",(0,r.jsx)(t.h3,{id:"query-response-format",children:"Response Format"}),"\n",(0,r.jsx)(t.p,{children:"The response format is newline-delimited JSON. Each log entry is contained in a JSON object and the various JSON objects are separated by newline character. Each JSON object has the following structure."}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{style:{textAlign:"left"},children:"Field"}),(0,r.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,r.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"_time"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"string"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:"Timestamp of the log entry in ISO 8601 format."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"_stream_id"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"string"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:"Unique identifier for the log stream."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"_stream"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"string"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:"Contains metadata such as environment, service name, and severity."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"_msg"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"string"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:"The main log message content."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"<log_field>"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"string"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:"Fields contained in the log entry."})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"For example"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-json",children:'{\n  "_time": "2025-10-13T09:12:01.665306801Z",\n  "_stream_id": "0000000100000000847aa29f7b9703df7835161f005721f0",\n  "_stream": "{env=\\"UNSET\\",service.name=\\"order\\",severity=\\"INFO\\"}",\n  "_msg": "Completed initialization in 3 ms",\n  "container.id": "4d368c1c1ef886e45c998bafdc93663208a0e38e6c478b558e83dcc34a3068f6",\n  "env": "UNSET",\n  "host.arch": "aarch64",\n  "host.name": "4d368c1c1ef8",\n  "os.description": "Linux 6.10.14-linuxkit",\n  "os.type": "linux",\n  "process.pid": "51",\n  "service.name": "order",\n  "severity": "INFO",\n  "telemetry.sdk.language": "java",\n  "telemetry.sdk.name": "opentelemetry",\n  "telemetry.sdk.version": "1.54.1",\n  "trace_id": "c7c1369bb478ff640385d1307b2cb088"\n}\n'})}),"\n",(0,r.jsx)(t.h2,{id:"deletion-delete-logs-from-cubeapm",children:"Deletion (delete logs from CubeAPM)"}),"\n",(0,r.jsx)(t.p,{children:"CubeAPM can delete logs matching desired criteria."}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Deletion APIs are served over a separate ",(0,r.jsx)(t.em,{children:"admin"})," port for strict access control. Further, the admin port is disabled by default. Please contact cubeapm support for help with enabling it."]}),"\n",(0,r.jsx)(t.li,{children:"If CubeAPM is running in cluster mode (multiple instances of CubeAPM), deletion APIs need to be executed separately for each instance."}),"\n",(0,r.jsx)(t.li,{children:"Deleted logs cannot be recovered. Use adequate caution when specifying filters for deletion."}),"\n"]})}),"\n",(0,r.jsx)(t.h3,{id:"run-delete-task",children:"Run Delete Task"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Endpoint:"})," ",(0,r.jsx)(t.code,{children:"POST"})," ",(0,r.jsx)(t.code,{children:"http://<ip_address_of_cubeapm_server>:3199/api/logs/delete/run_task"})]}),"\n",(0,r.jsx)(t.p,{children:"Starts a background task to delete logs matching the specified filter. The deletion task runs asynchronously and can be monitored or stopped using other APIs."}),"\n",(0,r.jsx)(t.h4,{id:"delete-run-task-request-parameters",children:"Request Parameters"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"filter"}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{children:"The logs query expression that selects logs to delete"})]})})]}),"\n",(0,r.jsxs)(t.p,{children:["The filter parameter uses logs query syntax, e.g. ",(0,r.jsx)(t.code,{children:'{env="production"} severity="ERROR" _time:[2025-01-01T00:00:00.000Z, 2025-01-02T00:00:00.000Z)'}),". For more details on query syntax, see the ",(0,r.jsx)(t.a,{href:"/logs/querying",children:"Logs Querying documentation"}),"."]}),"\n",(0,r.jsx)(t.h4,{id:"delete-run-task-curl",children:"curl"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"curl 'http://<cubeapm_server>:3199/api/logs/delete/run_task' \\\n  -H 'Content-Type: application/x-www-form-urlencoded' \\\n  --data-urlencode 'filter={env=\"production\",service.name=\"order\"} severity=\"ERROR\" _time:[2025-01-01T00:00:00.000Z, 2025-01-02T00:00:00.000Z)'\n"})}),"\n",(0,r.jsx)(t.h4,{id:"delete-run-task-response-format",children:"Response Format"}),"\n",(0,r.jsx)(t.p,{children:"The response is a JSON object containing the task ID:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Field"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"task_id"}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{children:"Unique identifier for the delete task. Use this ID to stop the task or check its status."})]})})]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Example Response:"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-json",children:'{\n  "task_id": "1738060800000000000"\n}\n'})}),"\n",(0,r.jsx)(t.h3,{id:"stop-delete-task",children:"Stop Delete Task"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Endpoint:"})," ",(0,r.jsx)(t.code,{children:"POST"})," ",(0,r.jsx)(t.code,{children:"http://<ip_address_of_cubeapm_server>:3199/api/logs/delete/stop_task"})]}),"\n",(0,r.jsx)(t.p,{children:"Stops a running delete task. Once stopped, the task will not continue deleting logs. Note that logs already deleted will not get restored."}),"\n",(0,r.jsx)(t.h4,{id:"delete-stop-task-request-parameters",children:"Request Parameters"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"task_id"}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsxs)(t.td,{children:["The task ID returned from the ",(0,r.jsx)(t.code,{children:"run_task"})," endpoint. Required."]})]})})]}),"\n",(0,r.jsx)(t.h4,{id:"delete-stop-task-curl",children:"curl"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"curl 'http://<cubeapm_server>:3199/api/logs/delete/stop_task' \\\n  -H 'Content-Type: application/x-www-form-urlencoded' \\\n  --data-urlencode 'task_id=1738060800000000000'\n"})}),"\n",(0,r.jsx)(t.h4,{id:"delete-stop-task-response-format",children:"Response Format"}),"\n",(0,r.jsx)(t.p,{children:"The response is a JSON object indicating success:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Field"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"status"}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{children:'Status of the operation. Returns "ok" on success.'})]})})]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Example Response:"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-json",children:'{\n  "status": "ok"\n}\n'})}),"\n",(0,r.jsx)(t.h3,{id:"list-active-delete-tasks",children:"List Active Delete Tasks"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Endpoint:"})," ",(0,r.jsx)(t.code,{children:"GET"})," ",(0,r.jsx)(t.code,{children:"http://<ip_address_of_cubeapm_server>:3199/api/logs/delete/active_tasks"})]}),"\n",(0,r.jsx)(t.p,{children:"Returns a list of all currently active (running or pending) delete tasks."}),"\n",(0,r.jsx)(t.h4,{id:"delete-active-tasks-request-parameters",children:"Request Parameters"}),"\n",(0,r.jsx)(t.p,{children:"This endpoint does not require any parameters."}),"\n",(0,r.jsx)(t.h4,{id:"delete-active-tasks-curl",children:"curl"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"curl 'http://<cubeapm_server>:3199/api/logs/delete/active_tasks'\n"})}),"\n",(0,r.jsx)(t.h4,{id:"delete-active-tasks-response-format",children:"Response Format"}),"\n",(0,r.jsx)(t.p,{children:"The response is a JSON array of delete task objects. Each task object has the following structure:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Field"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"task_id"}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{children:"Unique identifier for the delete task."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"filter"}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{children:"The LogsQL filter expression used for deletion."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"start_time"}),(0,r.jsx)(t.td,{children:"string"}),(0,r.jsx)(t.td,{children:"Timestamp when the task was created, in ISO 8601 format."})]})]})]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Example Response:"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-json",children:'[\n  {\n    "task_id": "1738060800000000000",\n    "filter": "{env=\\"production\\",service.name=\\"order\\"} severity=\\"ERROR\\"",\n    "start_time": "2025-01-28T10:00:00Z"\n  },\n  {\n    "task_id": "1738060900000000000",\n    "filter": "{env=\\"staging\\"} _time:<2025-01-01T00:00:00Z",\n    "start_time": "2025-01-28T11:00:00Z"\n  }\n]\n'})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>l,x:()=>d});var n=s(6540);const r={},i=n.createContext(r);function l(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);