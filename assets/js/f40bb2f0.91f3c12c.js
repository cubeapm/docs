"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9137],{8453:(e,s,r)=>{r.d(s,{R:()=>l,x:()=>o});var n=r(6540);const i={},t=n.createContext(i);function l(e){const s=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),n.createElement(t.Provider,{value:s},e.children)}},8573:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"mcp/mcp","title":"MCP Server","description":"CubeAPM provides an MCP (Model Context Protocol) server that allows AI assistants to query logs, metrics, and traces directly from CubeAPM. This enables AI assistants like Cursor and Claude Code to help you analyze your application performance data through natural language queries.","source":"@site/docs/mcp/mcp.md","sourceDirName":"mcp","slug":"/mcp-server","permalink":"/mcp-server","draft":false,"unlisted":false,"editUrl":"https://github.com/cubeapm/docs/docs/docs/mcp/mcp.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"slug":"/mcp-server","sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Traces","permalink":"/http-apis/traces-apis"}}');var i=r(4848),t=r(8453);const l={slug:"/mcp-server",sidebar_position:6},o="MCP Server",c={},d=[{value:"Quick Setup",id:"quick-setup",level:2},{value:"For Cursor",id:"for-cursor",level:3},{value:"For Claude Code (Anthropic)",id:"for-claude-code-anthropic",level:3},{value:"Configuration File Location",id:"configuration-file-location",level:4},{value:"Setup Steps",id:"setup-steps",level:4},{value:"Available Tools",id:"available-tools",level:2},{value:"Logs Tools",id:"logs-tools",level:3},{value:"Metrics Tools",id:"metrics-tools",level:3},{value:"Traces Tools",id:"traces-tools",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Example Queries",id:"example-queries",level:3},{value:"How It Works",id:"how-it-works",level:3}];function a(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"mcp-server",children:"MCP Server"})}),"\n",(0,i.jsx)(s.p,{children:"CubeAPM provides an MCP (Model Context Protocol) server that allows AI assistants to query logs, metrics, and traces directly from CubeAPM. This enables AI assistants like Cursor and Claude Code to help you analyze your application performance data through natural language queries."}),"\n",(0,i.jsx)(s.h2,{id:"quick-setup",children:"Quick Setup"}),"\n",(0,i.jsx)(s.h3,{id:"for-cursor",children:"For Cursor"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Open ",(0,i.jsx)(s.strong,{children:"Cursor Settings"})," \u2192 ",(0,i.jsx)(s.strong,{children:"Features"})," \u2192 ",(0,i.jsx)(s.strong,{children:"Model Context Protocol"})]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Add a new MCP server with the following configuration:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "cubeapm": {\n      "url": "http://<ip_address_of_cubeapm_server>:3140/mcp"\n    }\n  }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Restart Cursor to connect to the MCP server"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"for-claude-code-anthropic",children:"For Claude Code (Anthropic)"}),"\n",(0,i.jsx)(s.p,{children:"Claude Code reads MCP configuration from a config file. You can configure it at the user level or project level."}),"\n",(0,i.jsx)(s.h4,{id:"configuration-file-location",children:"Configuration File Location"}),"\n",(0,i.jsx)(s.p,{children:"Claude Code reads MCP config from:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"User-level config"}),": ",(0,i.jsx)(s.code,{children:"~/.claude/config.json"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Project-level config"}),": ",(0,i.jsx)(s.code,{children:".claude/config.json"})," (in your project root)"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Project-level config takes precedence over user-level config."}),"\n",(0,i.jsx)(s.h4,{id:"setup-steps",children:"Setup Steps"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Edit (or create) the configuration file:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-shell",children:"# For user-level configuration\nmkdir -p ~/.claude\nnano ~/.claude/config.json\n\n# Or for project-level configuration\nmkdir -p .claude\nnano .claude/config.json\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Add the CubeAPM MCP server configuration:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "cubeapm": {\n      "type": "http",\n      "url": "http://<ip_address_of_cubeapm_server>:3140/mcp"\n    }\n  }\n}\n'})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Restart Claude Code to connect to the MCP server"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"available-tools",children:"Available Tools"}),"\n",(0,i.jsx)(s.p,{children:"The CubeAPM MCP server provides the following tools for querying telemetry data:"}),"\n",(0,i.jsx)(s.h3,{id:"logs-tools",children:"Logs Tools"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Tool"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"discover_logs_stream_fields"})}),(0,i.jsx)(s.td,{children:"Discover available log fields and their values"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"query_logs"})}),(0,i.jsx)(s.td,{children:"Query log entries with filtering and search capabilities"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"get_log_hits"})}),(0,i.jsx)(s.td,{children:"Get log volume over time (time series data)"})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"metrics-tools",children:"Metrics Tools"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Tool"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"discover_metrics"})}),(0,i.jsx)(s.td,{children:"List all available metrics in the system"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"discover_label_values"})}),(0,i.jsx)(s.td,{children:"Get unique values for specific labels (services, environments, etc.)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"query_metrics_range"})}),(0,i.jsx)(s.td,{children:"Query metrics over a time range (returns time series data)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"query_metrics_instant"})}),(0,i.jsx)(s.td,{children:"Query metrics at a specific point in time"})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"traces-tools",children:"Traces Tools"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Tool"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"discover_traces_stream_fields"})}),(0,i.jsx)(s.td,{children:"Discover available trace streams"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"query_traces"})}),(0,i.jsx)(s.td,{children:"Query trace entries with filtering capabilities"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"get_trace_hits"})}),(0,i.jsx)(s.td,{children:"Get trace volume over time (time series data)"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,i.jsx)(s.p,{children:"Once connected, you can ask the AI assistant natural language questions about your telemetry data. The AI will automatically use the appropriate MCP tools to fetch the data from CubeAPM."}),"\n",(0,i.jsx)(s.h3,{id:"example-queries",children:"Example Queries"}),"\n",(0,i.jsx)(s.p,{children:"You can ask questions like:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Show me the last 10 logs for the order service"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"What is the RPM (requests per minute) of the order service?"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"What database queries are being used by the order service?"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"How many errors are there in the order service due to database issues?"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Show me traces for the payment service from the last hour"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"What is the p95 latency for the API gateway?"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"List all services that have errors in the last 24 hours"})}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"how-it-works",children:"How It Works"}),"\n",(0,i.jsx)(s.p,{children:"The AI assistant will automatically:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Discover metadata"})," - Use discovery tools to find available services, environments, and other metadata"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Construct queries"})," - Build appropriate queries using the MCP tools based on your question"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Retrieve data"})," - Fetch the relevant data from CubeAPM"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Present results"})," - Format and present the data in a readable format"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);